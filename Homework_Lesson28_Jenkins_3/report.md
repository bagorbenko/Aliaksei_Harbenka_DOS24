# –û—Ç—á–µ—Ç –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è

## üìå –ó–∞–¥–∞–Ω–∏–µ
### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≥–µ–Ω—Ç–∞ Jenkins –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
- –í –∫–∞—á–µ—Å—Ç–≤–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å–µ—Ä–≤–µ—Ä GCP —Å –û–° Ubuntu 22.04.
- –ê–≥–µ–Ω—Ç –±—ã–ª –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É Jenkins, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É –ª–æ–∫–∞–ª—å–Ω–æ (Macbook).
- –î–ª—è –ø—Ä–æ–±—Ä–æ—Å–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ GCP –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω **ngrok**, —Ç–∞–∫ –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞ NAT.
- –°–∫—Ä–∏–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ ngrok:
    ![ngrok –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ](./images/ngrok_connection.jpg)

---

### 2. –°–æ–∑–¥–∞–Ω–∏–µ pipeline –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ Jenkins
- –°–æ–∑–¥–∞–Ω pipeline –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º **FA_Jenkins_Test**.
- Pipeline –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ –∞–≥–µ–Ω—Ç–µ —Å –º–µ—Ç–∫–æ–π `gcp`.
- –ö–æ–¥ –¥–ª—è pipeline –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:  
    [GitHub Repository](https://github.com/bagorbenko/fast-api-jenkins-test)

---

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à–∞–≥–æ–≤ —Å–±–æ—Ä–∫–∏ –≤ pipeline
- –í pipeline –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã:
    - **Checkout** - –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
    - **Setup Python Environment** - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
    - **Run Tests** - –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º JUnit –∏ HTML –æ—Ç—á–µ—Ç–æ–≤.
    - **Deploy (–ø—É—Å—Ç–æ–π –∑–∞–≥–ª—É—à–∫–∞)** - –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç—Ç–∞–ø–∞.
- –í—Å–µ —à–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ **Pipeline Script (Declarative)**.

---

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
- –î–ª—è —Å–±–æ—Ä–∞ –æ—Ç—á–µ—Ç–æ–≤ –≤ Jenkins –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
    - **JUnit Plugin** - –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤ JUnit.
    - **HTML Publisher Plugin** - –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ HTML –æ—Ç—á–µ—Ç–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–µ—Å—Ç–æ–≤.
- –°–∫—Ä–∏–Ω HTML-–æ—Ç—á–µ—Ç–∞:
    ![HTML Test Report](./images/html_report.jpg)

---

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞
- –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞ –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω SSH-–∫–ª—é—á.
- –ö–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ `~/.ssh/authorized_keys` –Ω–∞ –∞–≥–µ–Ω—Ç–µ.
- –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∞–≥–µ–Ω—Ç–∞ Jenkins —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–µ–π **Known Hosts File Verification Strategy**.
- –°–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ö–æ—Å—Ç–æ–≤ (`known_hosts`) –±—ã–ª –æ–±–Ω–æ–≤–ª–µ–Ω —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:
    ```
    ssh-keyscan github.com >> ~/.ssh/known_hosts
    ```
- –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫–æ–¥–∞ –º–µ–∂–¥—É –º–∞—Å—Ç–µ—Ä-—Å–µ—Ä–≤–µ—Ä–æ–º Jenkins –∏ –∞–≥–µ–Ω—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–µ SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.
- –°–∫—Ä–∏–Ω —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∞–≥–µ–Ω—Ç–∞ –ø—Ä–∏–ª–∞–≥–∞–µ—Ç—Å—è.
    ![–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≥–µ–Ω—Ç–∞ Jenkins](./images/agent_settings.jpg)

---

### 6. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
- –ê–≥–µ–Ω—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –≤ –æ–±–ª–∞–∫–µ GCP.
- –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä Jenkins –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (macOS).
- –°–≤—è–∑—å –º–µ–∂–¥—É –Ω–∏–º–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ **ngrok**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∞–≥–µ–Ω—Ç–∞ –∏–∑ –æ–±–ª–∞—á–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É.

---

### 7. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram
- –í pipeline –¥–æ–±–∞–≤–ª–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –æ —Å—Ç–∞—Ç—É—Å–µ –∫–∞–∂–¥–æ–≥–æ –±–∏–ª–¥–∞.
- –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∏–ª–∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ–º –±–∏–ª–¥–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
    - –°—Ç–∞—Ç—É—Å –±–∏–ª–¥–∞.
    - –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞.
    - –ù–æ–º–µ—Ä –±–∏–ª–¥–∞.
    - –°—Å—ã–ª–∫–∞ –Ω–∞ –±–∏–ª–¥.
- –¢–∞–∫–∂–µ –≤ —á–∞—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è HTML-–æ—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö.
- –°–∫—Ä–∏–Ω—à–æ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram:
    ![Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ](./images/telegram_notification.jpg)

---

### üì¶ –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ **FastAPI**.
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
    - –≠–Ω–¥–ø–æ–∏–Ω—Ç `/` - –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞.
    - –¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **pytest** –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **httpx** –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
- –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ pipeline - —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –±–∏–ª–¥–∏—Ç—Å—è –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç—ã.

---